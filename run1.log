nohup: ignoring input
0, 1
lr: 1e-4, dropout: 0.05 , seed: 1, sample: 128

===================================BUG REPORT===================================
Welcome to bitsandbytes. For bug reports, please submit your error trace to: https://github.com/TimDettmers/bitsandbytes/issues
================================================================================
CUDA SETUP: CUDA runtime path found: /data/baokq/miniconda3/envs/alpaca_lora/lib/libcudart.so
CUDA SETUP: Highest compute capability among GPUs detected: 8.6
CUDA SETUP: Detected CUDA version 117
CUDA SETUP: Loading binary /data/baokq/miniconda3/envs/alpaca_lora/lib/python3.10/site-packages/bitsandbytes/libbitsandbytes_cuda117.so...
Training Alpaca-LoRA model with params:
base_model: /data/zhangjz/alpaca-lora/hugging_face_LLAMA_weights_7B/
train_data_path: /data/baokq/ml-100k/sequential_density_v1/train_v3.json
val_data_path: /data/baokq/ml-100k/sequential_sparse_v1/valid_v3.json
sample: 128
seed: 1
output_dir: /data/baokq/alpaca-lora/instruct_multi_7B_1e-4_0.05_1_128
batch_size: 128
micro_batch_size: 64
num_epochs: 200
learning_rate: 0.0001
cutoff_len: 512
lora_r: 8
lora_alpha: 16
lora_dropout: 0.05
lora_target_modules: ['q_proj', 'v_proj']
train_on_inputs: True
group_by_length: True
wandb_project: 
wandb_run_name: 
wandb_watch: 
wandb_log_model: 
resume_from_checkpoint: /data/baokq/alpaca-lora/alpaca-lora-7B

Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:07<00:07,  7.91s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.01s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:10<00:00,  5.44s/it]
Found cached dataset json (/home/baokq/.cache/huggingface/datasets/json/default-dd64e72eb39ef66d/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 35.15it/s]
Found cached dataset json (/home/baokq/.cache/huggingface/datasets/json/default-92f6a55986cfbc13/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 768.61it/s]
Found cached dataset json (/home/baokq/.cache/huggingface/datasets/json/default-973e13916591434f/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 350.43it/s]
Found cached dataset json (/home/baokq/.cache/huggingface/datasets/json/default-a67339fc1735968d/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51)
  0%|          | 0/1 [00:00<?, ?it/s]100%|██████████| 1/1 [00:00<00:00, 450.32it/s]
Restarting from /data/baokq/alpaca-lora/alpaca-lora-7B/adapter_model.bin
trainable params: 4194304 || all params: 6742609920 || trainable%: 0.06220594176090199
Loading cached shuffled indices for dataset at /home/baokq/.cache/huggingface/datasets/json/default-dd64e72eb39ef66d/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51/cache-07557bb7527ad5d5.arrow
Loading cached shuffled indices for dataset at /home/baokq/.cache/huggingface/datasets/json/default-973e13916591434f/0.0.0/0f7e3662623656454fcd2b650f34e886a7db4b9104504885bd462096cc7a9f51/cache-25891223d696adbe.arrow
Map:   0%|          | 0/256 [00:00<?, ? examples/s]Map:  32%|███▏      | 81/256 [00:00<00:00, 788.11 examples/s]Map:  66%|██████▌   | 169/256 [00:00<00:00, 831.95 examples/s]Map: 100%|██████████| 256/256 [00:00<00:00, 742.61 examples/s]                                                              Map:   0%|          | 0/1000 [00:00<?, ? examples/s]Map:  11%|█         | 109/1000 [00:00<00:00, 1069.72 examples/s]Map:  22%|██▏       | 220/1000 [00:00<00:00, 1085.63 examples/s]Map:  38%|███▊      | 377/1000 [00:00<00:00, 1057.34 examples/s]Map:  53%|█████▎    | 533/1000 [00:00<00:00, 1042.53 examples/s]Map:  69%|██████▊   | 686/1000 [00:00<00:00, 1030.26 examples/s]Map:  79%|███████▉  | 791/1000 [00:00<00:00, 1032.36 examples/s]Map:  90%|████████▉ | 896/1000 [00:00<00:00, 1034.36 examples/s]Map: 100%|██████████| 1000/1000 [00:01<00:00, 857.97 examples/s]                                                                Using the `WANDB_DISABLED` environment variable is deprecated and will be removed in v5. Use the --report_to flag to control the integrations used for logging result (for instance --report_to none).
  0%|          | 0/400 [00:00<?, ?it/s]  0%|          | 1/400 [00:32<3:38:20, 32.83s/it]  0%|          | 2/400 [01:04<3:33:36, 32.20s/it]  1%|          | 3/400 [01:36<3:31:39, 31.99s/it]  1%|          | 4/400 [02:08<3:30:27, 31.89s/it]  1%|▏         | 5/400 [02:39<3:29:43, 31.86s/it]  2%|▏         | 6/400 [03:11<3:29:00, 31.83s/it]  2%|▏         | 7/400 [03:43<3:28:24, 31.82s/it]  2%|▏         | 8/400 [04:15<3:27:48, 31.81s/it]                                                 {'loss': 1.3082, 'learning_rate': 4e-05, 'epoch': 4.0}
  2%|▏         | 8/400 [04:15<3:27:48, 31.81s/it]  2%|▏         | 9/400 [04:47<3:27:19, 31.81s/it]  2%|▎         | 10/400 [05:18<3:25:58, 31.69s/it]
  0%|          | 0/125 [00:00<?, ?it/s][A
  2%|▏         | 2/125 [00:00<00:30,  4.01it/s][A
  2%|▏         | 3/125 [00:00<00:42,  2.87it/s][A
  3%|▎         | 4/125 [00:01<00:49,  2.43it/s][A
  4%|▍         | 5/125 [00:02<00:53,  2.26it/s][A
  5%|▍         | 6/125 [00:02<00:54,  2.17it/s][A
  6%|▌         | 7/125 [00:02<00:55,  2.12it/s][A
  6%|▋         | 8/125 [00:03<00:57,  2.04it/s][A
  7%|▋         | 9/125 [00:04<00:57,  2.01it/s][A
  8%|▊         | 10/125 [00:04<00:58,  1.95it/s][A
  9%|▉         | 11/125 [00:05<00:59,  1.91it/s][A
 10%|▉         | 12/125 [00:05<00:59,  1.89it/s][A
 10%|█         | 13/125 [00:06<01:00,  1.86it/s][A
 11%|█         | 14/125 [00:06<00:58,  1.90it/s][A
 12%|█▏        | 15/125 [00:07<00:57,  1.91it/s][A
 13%|█▎        | 16/125 [00:07<00:55,  1.95it/s][A
 14%|█▎        | 17/125 [00:08<00:54,  1.98it/s][A
 14%|█▍        | 18/125 [00:08<00:55,  1.94it/s][A
 15%|█▌        | 19/125 [00:09<00:55,  1.91it/s][A
 16%|█▌        | 20/125 [00:09<00:54,  1.94it/s][A
 17%|█▋        | 21/125 [00:10<00:53,  1.95it/s][A
 18%|█▊        | 22/125 [00:10<00:52,  1.95it/s][A
 18%|█▊        | 23/125 [00:11<00:52,  1.94it/s][A
 19%|█▉        | 24/125 [00:11<00:52,  1.94it/s][A
 20%|██        | 25/125 [00:12<00:52,  1.92it/s][A
 21%|██        | 26/125 [00:12<00:50,  1.96it/s][A
 22%|██▏       | 27/125 [00:13<00:49,  1.97it/s][A
 22%|██▏       | 28/125 [00:13<00:48,  1.98it/s][A
 23%|██▎       | 29/125 [00:14<00:49,  1.96it/s][A
 24%|██▍       | 30/125 [00:14<00:49,  1.94it/s][A
 25%|██▍       | 31/125 [00:15<00:48,  1.94it/s][A
 26%|██▌       | 32/125 [00:15<00:48,  1.92it/s][A
 26%|██▋       | 33/125 [00:16<00:48,  1.92it/s][A
 27%|██▋       | 34/125 [00:16<00:46,  1.95it/s][A
 28%|██▊       | 35/125 [00:17<00:45,  1.97it/s][A
 29%|██▉       | 36/125 [00:17<00:44,  1.98it/s][A
 30%|██▉       | 37/125 [00:18<00:44,  1.99it/s][A
 30%|███       | 38/125 [00:19<00:43,  1.98it/s][A
 31%|███       | 39/125 [00:19<00:43,  1.97it/s][A
 32%|███▏      | 40/125 [00:20<00:42,  1.99it/s][A
 33%|███▎      | 41/125 [00:20<00:42,  1.96it/s][A
 34%|███▎      | 42/125 [00:21<00:42,  1.95it/s][A
 34%|███▍      | 43/125 [00:21<00:42,  1.94it/s][A
 35%|███▌      | 44/125 [00:22<00:41,  1.93it/s][A
 36%|███▌      | 45/125 [00:22<00:41,  1.93it/s][A
 37%|███▋      | 46/125 [00:23<00:40,  1.97it/s][A
 38%|███▊      | 47/125 [00:23<00:39,  1.99it/s][A
 38%|███▊      | 48/125 [00:24<00:39,  1.97it/s][A
 39%|███▉      | 49/125 [00:24<00:38,  1.96it/s][A
 40%|████      | 50/125 [00:25<00:38,  1.95it/s][A
 41%|████      | 51/125 [00:25<00:38,  1.95it/s][A
 42%|████▏     | 52/125 [00:26<00:38,  1.92it/s][A
 42%|████▏     | 53/125 [00:26<00:37,  1.90it/s][A
 43%|████▎     | 54/125 [00:27<00:37,  1.88it/s][A
 44%|████▍     | 55/125 [00:27<00:37,  1.88it/s][A
 45%|████▍     | 56/125 [00:28<00:36,  1.88it/s][A
 46%|████▌     | 57/125 [00:28<00:36,  1.88it/s][A
 46%|████▋     | 58/125 [00:29<00:35,  1.89it/s][A
 47%|████▋     | 59/125 [00:29<00:35,  1.87it/s][A
 48%|████▊     | 60/125 [00:30<00:35,  1.84it/s][A
 49%|████▉     | 61/125 [00:31<00:34,  1.86it/s][A
 50%|████▉     | 62/125 [00:31<00:33,  1.90it/s][A
 50%|█████     | 63/125 [00:32<00:33,  1.86it/s][A
 51%|█████     | 64/125 [00:32<00:33,  1.85it/s][A
 52%|█████▏    | 65/125 [00:33<00:32,  1.87it/s][A
 53%|█████▎    | 66/125 [00:33<00:30,  1.91it/s][A
 54%|█████▎    | 67/125 [00:34<00:30,  1.91it/s][A
 54%|█████▍    | 68/125 [00:34<00:29,  1.91it/s][A
 55%|█████▌    | 69/125 [00:35<00:29,  1.92it/s][A
 56%|█████▌    | 70/125 [00:35<00:28,  1.94it/s][A
 57%|█████▋    | 71/125 [00:36<00:27,  1.94it/s][A
 58%|█████▊    | 72/125 [00:36<00:27,  1.94it/s][A
 58%|█████▊    | 73/125 [00:37<00:26,  1.96it/s][A
 59%|█████▉    | 74/125 [00:37<00:26,  1.95it/s][A
 60%|██████    | 75/125 [00:38<00:25,  1.97it/s][A
 61%|██████    | 76/125 [00:38<00:25,  1.95it/s][A
 62%|██████▏   | 77/125 [00:39<00:24,  1.95it/s][A
 62%|██████▏   | 78/125 [00:39<00:23,  1.96it/s][A
 63%|██████▎   | 79/125 [00:40<00:23,  1.95it/s][A
 64%|██████▍   | 80/125 [00:40<00:22,  1.97it/s][A
 65%|██████▍   | 81/125 [00:41<00:23,  1.88it/s][A
 66%|██████▌   | 82/125 [00:42<00:23,  1.82it/s][A
 66%|██████▋   | 83/125 [00:42<00:23,  1.77it/s][A
 67%|██████▋   | 84/125 [00:43<00:23,  1.73it/s][A
 68%|██████▊   | 85/125 [00:43<00:22,  1.78it/s][A
 69%|██████▉   | 86/125 [00:44<00:21,  1.83it/s][A
 70%|██████▉   | 87/125 [00:44<00:20,  1.86it/s][A
 70%|███████   | 88/125 [00:45<00:19,  1.88it/s][A
 71%|███████   | 89/125 [00:45<00:18,  1.89it/s][A
 72%|███████▏  | 90/125 [00:46<00:18,  1.90it/s][A
 73%|███████▎  | 91/125 [00:46<00:17,  1.91it/s][A
 74%|███████▎  | 92/125 [00:47<00:17,  1.92it/s][A
 74%|███████▍  | 93/125 [00:47<00:16,  1.95it/s][A
 75%|███████▌  | 94/125 [00:48<00:16,  1.93it/s][A
 76%|███████▌  | 95/125 [00:48<00:15,  1.90it/s][A
 77%|███████▋  | 96/125 [00:49<00:15,  1.88it/s][A
 78%|███████▊  | 97/125 [00:50<00:14,  1.87it/s][A
 78%|███████▊  | 98/125 [00:50<00:14,  1.89it/s][A
 79%|███████▉  | 99/125 [00:51<00:13,  1.90it/s][A
 80%|████████  | 100/125 [00:51<00:13,  1.91it/s][A
 81%|████████  | 101/125 [00:52<00:12,  1.94it/s][A
 82%|████████▏ | 102/125 [00:52<00:12,  1.91it/s][A
 82%|████████▏ | 103/125 [00:53<00:11,  1.89it/s][A
 83%|████████▎ | 104/125 [00:53<00:11,  1.89it/s][A
 84%|████████▍ | 105/125 [00:54<00:10,  1.92it/s][A
 85%|████████▍ | 106/125 [00:54<00:09,  1.91it/s][A
 86%|████████▌ | 107/125 [00:55<00:09,  1.90it/s][A
 86%|████████▋ | 108/125 [00:55<00:08,  1.90it/s][A
 87%|████████▋ | 109/125 [00:56<00:08,  1.89it/s][A
 88%|████████▊ | 110/125 [00:56<00:07,  1.90it/s][A
 89%|████████▉ | 111/125 [00:57<00:07,  1.84it/s][A
 90%|████████▉ | 112/125 [00:57<00:06,  1.89it/s][A
 90%|█████████ | 113/125 [00:58<00:06,  1.90it/s][A
 91%|█████████ | 114/125 [00:58<00:05,  1.93it/s][A
 92%|█████████▏| 115/125 [00:59<00:05,  1.93it/s][A
 93%|█████████▎| 116/125 [00:59<00:04,  1.92it/s][A
 94%|█████████▎| 117/125 [01:00<00:04,  1.92it/s][A
 94%|█████████▍| 118/125 [01:01<00:03,  1.91it/s][A
 95%|█████████▌| 119/125 [01:01<00:03,  1.89it/s][A
 96%|█████████▌| 120/125 [01:02<00:02,  1.89it/s][A
 97%|█████████▋| 121/125 [01:02<00:02,  1.87it/s][A
 98%|█████████▊| 122/125 [01:03<00:01,  1.86it/s][A
 98%|█████████▊| 123/125 [01:03<00:01,  1.87it/s][A
 99%|█████████▉| 124/125 [01:04<00:00,  1.88it/s][A
100%|██████████| 125/125 [01:04<00:00,  1.89it/s][A                                                  
                                                 [A{'eval_loss': 0.9033198356628418, 'eval_auc': 0.49131250111093344, 'eval_runtime': 65.3121, 'eval_samples_per_second': 15.311, 'eval_steps_per_second': 1.914, 'epoch': 5.0}
  2%|▎         | 10/400 [06:23<3:25:58, 31.69s/it]
100%|██████████| 125/125 [01:04<00:00,  1.89it/s][A
                                                 [A  3%|▎         | 11/400 [06:55<5:35:28, 51.74s/it]  3%|▎         | 12/400 [07:27<4:55:24, 45.68s/it]  3%|▎         | 13/400 [07:59<4:27:33, 41.48s/it]  4%|▎         | 14/400 [08:30<4:07:16, 38.44s/it]  4%|▍         | 15/400 [09:02<3:53:47, 36.44s/it]  4%|▍         | 16/400 [09:34<3:44:13, 35.04s/it]                                                  {'loss': 1.1467, 'learning_rate': 8e-05, 'epoch': 8.0}
  4%|▍         | 16/400 [09:34<3:44:13, 35.04s/it]  4%|▍         | 17/400 [10:06<3:37:24, 34.06s/it]  4%|▍         | 18/400 [10:37<3:32:29, 33.38s/it]